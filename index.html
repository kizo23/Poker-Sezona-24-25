<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POKER 24/25 - Rankings and Game History</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        body { font-family: 'Arial', sans-serif; background: #121212; color: white; margin: 0; padding: 0; }
        header { background: linear-gradient(90deg, #009f4d, #d7263d); padding: 15px; text-align: center; color: white; }
        header h1 { font-size: 2.5em; font-weight: bold; }
        .section { margin: 20px auto; padding: 20px; max-width: 1200px; background: #1e1e1e; border-radius: 10px; }
        table { width: 100%; text-align: center; color: white; }
        table th { padding: 8px; border: 1px solid rgba(255, 255, 255, 0.2); cursor: pointer; }
        table td, table th { padding: 8px; border: 1px solid rgba(255, 255, 255, 0.2); }
        th:hover { background-color: #333; }
        .player-tooltip { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9); color: white; padding: 10px; border-radius: 5px; white-space: nowrap; z-index: 1000; }
        .player-name:hover .player-tooltip { display: block; }
        .first-place { font-weight: bold; color: yellow; }
        .second-place { font-weight: bold; color: orange; }
        .third-place { font-weight: bold; color: red; }
        .players-row { font-size: 0.8em; color: gray; text-align: left; }
        .sortable { cursor: pointer; }
    </style>
</head>
<body>
    <header>
        <h1>POKER 24/25</h1>
    </header>
    <main class="container">
        <!-- Rankings Section -->
        <section class="section">
            <h2>RANKINGS</h2>
            <table id="rankings-table">
                <thead>
                    <tr>
                        <th class="sortable">Player</th>
                        <th class="sortable">Points</th>
                        <th class="sortable">Games</th>
                        <th class="sortable">Wins</th>
                        <th class="sortable">Rebuys</th>
                        <th class="sortable">Net (€)</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Rankings data will be injected here dynamically -->
                </tbody>
            </table>
        </section>

        <!-- Game History Section -->
        <section class="section">
            <h2>GAME HISTORY</h2>
            <table>
                <thead>
                    <tr>
                        <th>Results</th>
                        <th>Players</th>
                        <th>Rebuys</th>
                    </tr>
                </thead>
                <tbody id="game-history">
                    <!-- Game history data will be injected here dynamically -->
                </tbody>
            </table>
        </section>
    </main>
    <script>
        // Centralized Game Data
        const games = [
            {
                players: ["Sebo", "Ogi", "Zane", "Robi", "Kizo"],
                rebuys: ["Robi", "Zane", "Kizo"],
                results: ["Zane", "Sebo", "Kizo"]
            },
            {
                players: ["Nedo", "Ruben", "Peko", "Sašo", "Zane", "Robi", "Kizo"],
                rebuys: ["Nedo", "Robi", "Kizo"],
                results: ["Robi", "Kizo", "Zane"]
            },
            {
                players: ["Kizo", "Ruben", "Nimčo", "Ogi", "Zane", "Sebo", "Robi", "Nedo"],
                rebuys: ["Kizo", "Ogi", "Nimčo", "Sebo", "Nedo"],
                results: ["Robi", "Kizo", "Nimčo"]
            }
        ];

        // Players Statistics
        const playerStats = {};

        // Process Games to Update Stats
        games.forEach(game => {
            // Calculate total pot
            const totalPot = (game.players.length * 5) + (game.rebuys.length * 5);

            // Assign points for the results and calculate money won
            game.results.forEach((player, index) => {
                if (!playerStats[player]) {
                    playerStats[player] = { points: 0, games: 0, wins: 0, rebuys: 0, earned: 0, spent: 0, net: 0 };
                }
                playerStats[player].points += [3, 2, 1][index]; // Points for 1st, 2nd, 3rd place
                if (index === 0) { // 1st place earns the total pot
                    playerStats[player].earned += totalPot;
                    playerStats[player].wins += 1;
                }
            });

            // Update games played and rebuys
            game.players.forEach(player => {
                if (!playerStats[player]) {
                    playerStats[player] = { points: 0, games: 0, wins: 0, rebuys: 0, earned: 0, spent: 0, net: 0 };
                }
                playerStats[player].games += 1;
                playerStats[player].spent += 5; // Base buy-in
            });

            game.rebuys.forEach(player => {
                if (!playerStats[player]) {
                    playerStats[player] = { points: 0, games: 0, wins: 0, rebuys: 0, earned: 0, spent: 0, net: 0 };
                }
                playerStats[player].rebuys += 1;
                playerStats[player].spent += 5; // Rebuy cost
            });
        });

        // Calculate Net Earnings
        Object.keys(playerStats).forEach(player => {
            const stats = playerStats[player];
            stats.net = stats.earned - stats.spent; // Correct net calculation
        });

        // Populate Rankings Table
        const rankingsTableBody = document.querySelector("#rankings-table tbody");
        const sortedPlayers = Object.entries(playerStats).sort((a, b) => b[1].points - a[1].points);
        sortedPlayers.forEach(([player, stats], index) => {
            const row = document.createElement("tr");
            if (index === 0) row.style.color = "yellow"; // First place
            if (index === 1) row.style.color = "orange"; // Second place
            if (index === 2) row.style.color = "red"; // Third place
            row.innerHTML = `
                <td class="player-name">${player}
                    <div class="player-tooltip">
                        Points: ${stats.points}<br>
                        Games: ${stats.games}<br>
                        Wins: ${stats.wins}<br>
                        Rebuys: ${stats.rebuys}<br>
                        Net: ${stats.net}€
                    </div>
                </td>
                <td>${stats.points}</td>
                <td>${stats.games}</td>
                <td>${stats.wins}</td>
                <td>${stats.rebuys}</td>
                <td>${stats.net}€</td>
            `;
            rankingsTableBody.appendChild(row);
        });

        // Populate Game History
        const gameHistoryBody = document.querySelector("#game-history");
        games.forEach((game, index) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>
                    <span class="first-place">${game.results[0]}</span>, 
                    <span class="second-place">${game.results[1]}</span>, 
                    <span class="third-place">${game.results[2]}</span>
                </td>
                <td>${game.players.join(", ")}</td>
                <td>${game.rebuys.join(", ")}</td>
            `;
            gameHistoryBody.appendChild(row);
        });
    </script>
</body>
</html>
